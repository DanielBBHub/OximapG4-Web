<!DOCTYPE html>
<html>


    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Editar perfil</title>

        <!-- CSS only -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        
        <!-- JavaScript Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <!-- Importando la logica fake en html para darle funcionalidad a los botones -->
        
        <script src="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.js"></script>
        <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.css" /> 
        </head>


    <body>
        <img>
        <div >
            <h2>Perfil</h2>
        </div>
        <br>

        <h4  >Nombre</h4>
        <h4 id="nombreUsuarioTxt"> 
        </h4>
        <input id="cambiarNombreTXT"></input>
        <br>

        <h4  >Correo </h4>
        <h4 id="correoUsuarioTxt"> 
        </h4>
        <input id="cambiarCorreoTXT"></input>
        <br>

        <a id="resetContra">¿Has olvidado la contraseña?</a>
        <!-- <h4  >Contraseña antigua</h4>
       
        <input id="viejaContraseñaTXT"></input>
        <br>

        <h4  >Contraseña nueva</h4>
       
        <input id="nuevaContrasenyaTXT"></input>
        <br> -->
        <br>
        <button id="editarPerfilBoton">Editar perfil</button>
        



        <footer class="text-center text-white fixed-bottom" style="background-color: #000;">
            <!-- Grid container -->
            <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
              © 2022 <a class="text-white" href="https://www.upv.es/va">Universitat Politècnica de València</a> | 
            </div>
        </footer>


        <script type="module">
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-app.js";
            import { getAuth, onAuthStateChanged  } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-auth.js";
            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            const firebaseConfig = {
                apiKey: "AIzaSyBBGGWQJI519Xm8VM8Ocn0P9RSxdSK-s5I",
                authDomain: "oximapg4-login.firebaseapp.com",
                projectId: "oximapg4-login",
                storageBucket: "oximapg4-login.appspot.com",
                messagingSenderId: "905799197481",
                appId: "1:905799197481:web:e136730907ae07b3b90d38",
                measurementId: "G-KCP6LXPCH5"
            };


            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            // Initialize Firebase Authentication and get a reference to the service
            const auth = getAuth(app);
            import firebaseutil from "./js/firebase_util.js"
            import {sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-auth.js";

            document.onreadystatechange = function() {
                let util = new firebaseutil()
                const auth = getAuth();
                onAuthStateChanged(auth, (user) => {
                
                if (user) {
                    // User is signed in, see docs for a list of available properties
                    // https://firebase.google.com/docs/reference/js/firebase.User
                    document.getElementById("nombreUsuarioTxt").textContent = user.displayName
                    document.getElementById("correoUsuarioTxt").textContent = user.email
                    // ...
                } else {
                    // User is signed out
                    // ...
                }
                });
                
                document.getElementById("editarPerfilBoton").addEventListener("click" , async function(){
                    util.editar_perfil()
                })

                document.getElementById("resetContra").addEventListener("click", async function(){
                    sendPasswordResetEmail(auth, auth.currentUser.email)
                    .then(() => {
                        // Password reset email sent!
                        // ..
                    })
                })
            } 
        </script>   
    </body>


</html>